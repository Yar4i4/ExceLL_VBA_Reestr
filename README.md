Данный код открывает диалоговое окно непосредственно в той же папке, в которой находится файл запуска макроса и предлагает пользователю выбрать файлы, которые будут обработаны и добавлены в реестр. 
Далее происходит обработка данных, учитывающая три основных события (отсутствует, есть, есть более 1). 
И в зависимости от найденных значений происходит их формирование и вывод в том виде, в котором требуется для составления реестра.
Пользователю остается выбрать массив и вручную вставить его, предварительно проверив. 
Ручной перенос можно автоматизировать, но это обошёл, чтобы дать возможность пользователю ближе познакомиться с результатами макроса.
